@use "sass:math";
@use "sass:string";
@use "@/styles/mq" as mq;
// -----------------------------------------------------------------------------
// Starfield configuration
// -----------------------------------------------------------------------------
$star-color: #655a20;

$space-height-desktop: 600px;
$space-height-mobile: 800px;        // controls vertical loop distance (your animation)

$stars-small-count-desktop: 700;
$stars-medium-count-desktop: 200;
$stars-big-count-desktop: 100;

$stars-small-count-mobile: 160;
$stars-medium-count-mobile: 60;
$stars-big-count-mobile: 25;

$spread-width-desktop: 6000;
$spread-height-desktop: 2000;
$spread-width-mobile: 900;
$spread-height-mobile: 1000;

// -----------------------------------------------------------------------------
// Generate multiple box-shadows (compile-time randomness)
// -----------------------------------------------------------------------------
@function multiple-box-shadow($count, $spread-width, $spread-height ) {
  $value: "#{math.random($spread-width)}px #{math.random($spread-height)}px #{$star-color}";
  @for $i from 2 through $count {
    $value: "#{$value}, #{math.random($spread-width)}px #{math.random($spread-height)}px #{$star-color}";
  }
  @return string.unquote($value);
}


// precompute once (compile-time)
$shadows-small-mobile:  multiple-box-shadow($stars-small-count-mobile, $spread-width-mobile, $spread-height-mobile);
$shadows-medium-mobile: multiple-box-shadow($stars-medium-count-mobile, $spread-width-mobile,$spread-height-mobile);
$shadows-big-mobile:    multiple-box-shadow($stars-big-count-mobile, $spread-width-mobile, $spread-height-mobile);

$shadows-small-desktop:  multiple-box-shadow($stars-small-count-desktop, $spread-width-desktop, $spread-height-desktop);
$shadows-medium-desktop: multiple-box-shadow($stars-medium-count-desktop, $spread-width-desktop, $spread-height-desktop);
$shadows-big-desktop:    multiple-box-shadow($stars-big-count-desktop, $spread-width-desktop, $spread-height-desktop);


// --------------------
// Mobile baseline
// --------------------
.stars,
.stars2,
.stars3 {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: transparent;
  overflow: hidden;
}

.stars {
  width: 1px;
  height: 1px;
  box-shadow: $shadows-small-mobile;
  animation: animStarMobile 70s linear infinite;
}

.stars2 {
  width: 2px;
  height: 2px;
  box-shadow: $shadows-medium-mobile;
  animation: animStarMobile 120s linear infinite;
}

.stars3 {
  width: 3px;
  height: 3px;
  box-shadow: $shadows-big-mobile;
  animation: animStarMobile 180s linear infinite;
}

@keyframes animStarMobile {
  from { transform: translateY(0); }
  to   { transform: translateY(-$space-height-mobile); }
}


// --------------------
// Desktop upgrade
// --------------------
@include mq.up(desktop) {
  .stars,
  .stars2,
  .stars3 {
    will-change: transform;

    &::after {
      content: '';
      position: absolute;
      top: $space-height-desktop;
      left: 0;
      background: transparent;
    }
  }

  .stars {
    box-shadow: $shadows-small-desktop;
    animation: animStarDesktop 50s linear infinite;

    &::after {
      width: 1px;
      height: 1px;
      box-shadow: $shadows-small-desktop;
    }
  }

  .stars2 {
    box-shadow: $shadows-medium-desktop;
    animation: animStarDesktop 100s linear infinite;

    &::after {
      width: 2px;
      height: 2px;
      box-shadow: $shadows-medium-desktop;
    }
  }

  .stars3 {
    box-shadow: $shadows-big-desktop;
    animation: animStarDesktop 150s linear infinite;

    &::after {
      width: 3px;
      height: 3px;
      box-shadow: $shadows-big-desktop;
    }
  }

  @keyframes animStarDesktop {
    from { transform: translateY(0); }
    to   { transform: translateY(-$space-height-desktop); }
  }
}

@media (prefers-reduced-motion: reduce) {
  .stars,
  .stars2,
  .stars3 {
    animation: none !important;
  }

  .stars::after,
  .stars2::after,
  .stars3::after {
    content: none !important;
  }
}